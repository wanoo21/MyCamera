!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){const r=n(1);customElements.define("my-camera",class extends HTMLElement{constructor(){super(),this._shadow=this.attachShadow({mode:"closed"}),this._recordedChunks=[],this._shadow.innerHTML=this.renderHtml(),this._video=this._shadow.querySelector("video"),this._error=this._shadow.querySelector("p"),this._record=this._shadow.querySelector("button.record"),this.hasAttribute("record")?this._record.addEventListener("click",()=>this._record.hasAttribute("recording")?(this._record.innerText="Record",this._record.removeAttribute("recording"),this._stopRecording()):(this._record.innerText="Recording ...",this._record.setAttribute("recording",""),this._startRecording())):this._record.remove()}static get observedAttributes(){return["autoplay","controls","audio"]}_startRecording(){this._recorder.start(100)}_stopRecording(){this._recorder.stop();const e=URL.createObjectURL(new Blob(this._recordedChunks,{type:this._recorder.mimeType})),t=this._shadow.ownerDocument.createElement("a");t.style.display="none",t.href=e,t.download=`my-camera-record-${this._recordedChunks.length}.webm`,this._shadow.appendChild(t),t.click(),setTimeout(()=>{this._recordedChunks=[],this._shadow.removeChild(t),URL.revokeObjectURL(e)},100)}_cameraStream(){return navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:{width:{min:320,ideal:1280,max:1920},height:{min:240,ideal:720,max:1080},facingMode:"user"},audio:this.hasAttribute("audio")}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}_addVideoAtributes(){this._video.autoplay=this.hasAttribute("autoplay"),this._video.controls=this.hasAttribute("controls")}async connectedCallback(){try{this._video.srcObject=await this._cameraStream(),this._addVideoAtributes(),this.hasAttribute("record")&&(this._recorder=new r(this._video.srcObject,{mimeType:"video/webm"}),this._recorder.addEventListener("dataavailable",({data:e})=>{this._recordedChunks.push(e)})),this._error.remove()}catch(e){if(this._video.remove(),this._record.remove(),"ConstraintNotSatisfiedError"===e.name)this._error.innerText="The resolution is not supported by your device.";else{if("NotAllowedError"!==e.name)throw this._error.innerText=e.message,Error(e);this._error.innerText="Permissions have not been granted to use your camera and microphone, you need to allow the page access to your devices in order for the demo to work."}}}disconnectedCallback(){console.log("My Camera is disconnected")}attributeChangedCallback(e,t,n){}renderHtml(){return'\n        <style>\n          :host {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            flex-direction: column;\n            position: relative;\n            background-color: var(--background-color, #ccc);\n            height: var(--height, 400px);\n            width: var(--width, 400px);\n          }\n\n          video {\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0, 0, 0, 0);\n          }\n\n          .error {\n            color: var(--color, red);\n            font-size: 1em;\n            // font-weight: bold;\n            text-align: center;\n          }\n\n          .custom-controls {\n            top: 8px;\n            left: 8px;\n            width: 100%;\n            position: absolute;\n          }\n\n          .custom-controls button {\n            padding: 8px 10px;\n          }\n\n        </style>\n        <video playsinline></video>\n        <p class="error"></p>\n        <div class="custom-controls">\n          <button class="record">Record</button>\n        </div>\n      '}})},function(e,t,n){var r,i=window.AudioContext||window.webkitAudioContext;function o(e){this.stream=e,this.state="inactive",this.em=document.createDocumentFragment(),this.encoder=function(e){var t=e.toString().replace(/^function\s*\(\)\s*{/,"").replace(/}$/,""),n=new Blob([t]);return new Worker(URL.createObjectURL(n))}(o.encoder);var t=this;this.encoder.addEventListener("message",function(e){var n=new Event("dataavailable");n.data=new Blob([e.data],{type:t.mimeType}),t.em.dispatchEvent(n),"inactive"===t.state&&t.em.dispatchEvent(new Event("stop"))})}o.prototype={mimeType:"audio/wav",start:function(e){if("inactive"===this.state){this.state="recording",r||(r=new i);var t=r.createMediaStreamSource(this.stream),n=r.createScriptProcessor(2048,1,1),o=this;n.onaudioprocess=function(e){"recording"===o.state&&o.encoder.postMessage(["encode",e.inputBuffer.getChannelData(0)])},t.connect(n),n.connect(r.destination),this.em.dispatchEvent(new Event("start")),e&&(this.slicing=setInterval(function(){"recording"===o.state&&o.requestData()},e))}},stop:function(){"inactive"!==this.state&&(this.requestData(),this.state="inactive",clearInterval(this.slicing))},pause:function(){"recording"===this.state&&(this.state="paused",this.em.dispatchEvent(new Event("pause")))},resume:function(){"paused"===this.state&&(this.state="recording",this.em.dispatchEvent(new Event("resume")))},requestData:function(){"inactive"!==this.state&&this.encoder.postMessage(["dump",r.sampleRate])},addEventListener:function(){this.em.addEventListener.apply(this.em,arguments)},removeEventListener:function(){this.em.removeEventListener.apply(this.em,arguments)},dispatchEvent:function(){this.em.dispatchEvent.apply(this.em,arguments)}},o.isTypeSupported=function(e){return/audio\/wave?/.test(e)},o.notSupported=!navigator.mediaDevices||!i,o.encoder=n(2),e.exports=o},function(e,t){e.exports=function(){var e=2,t=[];onmessage=function(n){"encode"===n.data[0]?function(n){for(var r=n.length,i=new Uint8Array(r*e),o=0;o<r;o++){var s=o*e,a=n[o];a>1?a=1:a<-1&&(a=-1),a*=32768,i[s]=a,i[s+1]=a>>8}t.push(i)}(n.data[1]):function(n){var r=t.length?t[0].length:0,i=t.length*r,o=new Uint8Array(44+i),s=new DataView(o.buffer);s.setUint32(0,1380533830,!1),s.setUint32(4,36+i,!0),s.setUint32(8,1463899717,!1),s.setUint32(12,1718449184,!1),s.setUint32(16,16,!0),s.setUint16(20,1,!0),s.setUint16(22,1,!0),s.setUint32(24,n,!0),s.setUint32(28,n*e,!0),s.setUint16(32,e,!0),s.setUint16(34,8*e,!0),s.setUint32(36,1684108385,!1),s.setUint32(40,i,!0);for(var a=0;a<t.length;a++)o.set(t[a],a*r+44);t=[],postMessage(o.buffer,[o.buffer])}(n.data[1])}}}]);